mod TWOWATERTANKSYSTEM_SIMPLE_INSTANCE-MODEL is
	including MODEL-TRANSITION-SYSTEM .
	
	--- AADL identifiers
	ops t : -> VarId [ctor] .
	ops decreasedwater releasedwater incomingwater offcontrol increasedwater oncontrol power currwater : -> FeatureId [ctor] .
	ops TwoWaterTankSystemsimpleInstance ctrlThread pumppower waterTank2 waterTank1 ctrlProc env2 env1 increase water decrease : -> ComponentId [ctor] .
	ops init exec off on : -> Location [ctor] .
	ops loopBoundNum transBoundNum : -> Nat .
	--- the initial state
	op initial : -> Object .
	eq initial = < TwoWaterTankSystemsimpleInstance : System |
		features : (
			none),
		subcomponents : (
			< waterTank1 : System |
				features : (
					< releasedwater : DataOutPort | 
						content : null(Real) ,
						properties : (DataModel::InitialValue => {{0}}) >
					< power : DataOutPort | 
						content : null(Real) ,
						properties : (DataModel::InitialValue => {{0}}) >
					< decreasedwater : DataInPort | 
						cache : null(Real),
						content : null(Real) ,
						properties : none >
					< currwater : DataInPort | 
						cache : null(Real),
						content : null(Real) ,
						properties : none >
					< oncontrol : DataOutPort | 
						content : null(Unit) ,
						properties : none >
					< offcontrol : DataOutPort | 
						content : null(Unit) ,
						properties : none >),
				subcomponents : (
					< ctrlProc : Process |
						features : (
							< releasedwater : DataOutPort | 
								content : null(Real) ,
								properties : none >
							< power : DataOutPort | 
								content : null(Real) ,
								properties : none >
							< decreasedwater : DataInPort | 
								cache : null(Real),
								content : null(Real) ,
								properties : none >
							< currwater : DataInPort | 
								cache : null(Real),
								content : null(Real) ,
								properties : none >
							< oncontrol : DataOutPort | 
								content : null(Unit) ,
								properties : none >
							< offcontrol : DataOutPort | 
								content : null(Unit) ,
								properties : none >),
						subcomponents : (
							< ctrlThread : Thread |
								features : (
									< releasedwater : DataOutPort | 
										content : null(Real) ,
										properties : none >
									< decreasedwater : DataInPort | 
										cache : null(Real),
										content : null(Real) ,
										properties : none >
									< currwater : DataInPort | 
										cache : null(Real),
										content : null(Real) ,
										properties : none >
									< power : DataOutPort | 
										content : null(Real) ,
										properties : none >
									< oncontrol : DataOutPort | 
										content : null(Unit) ,
										properties : none >
									< offcontrol : DataOutPort | 
										content : null(Unit) ,
										properties : none >),
								subcomponents : (
									none),
								currState : (
									init),
								completeStates : (
									init),
								variables : (
									empty),
								transitions : (
									(init -[ on dispatch ]-> exec {
										(f{releasedwater} := f[decreasedwater])
									}) ;
									(exec -[ [[true]] ]-> init {
										if ((f[currwater] <= [[33]])){
											(f{power} := [[0.5]]) ;
											(oncontrol !)
										}
										(
										(elsif ((f[currwater] <= [[39]])){
											(f{power} := [[0.3]]) ;
											(oncontrol !)
										})
										)
										else {
											{
												(f{power} := [[0.0]]) ;
												(offcontrol !)
											}
										}
										end if
									})),
								loopBound : (
									loopBoundNum),
								transBound : (
									transBoundNum),
								varGen : (
									< "TwoWaterTankSystemsimpleInstance.waterTank1.ctrlProc.ctrlThread" >
									),
								properties : (
									(TimingProperties::Period => {{100.0}}) ;
									(HybridSynchAADL::MaxClockDeviation => {{5.0}}) ;
									(HybridSynchAADL::SamplingTime => {{20.0 .. 30.0}}) ;
									(HybridSynchAADL::ResponseTime => {{60.0 .. 80.0}}) ;
									(HybridSynchAADL::Synchronous => {{true}})),
								connections : (
									empty) 
								> ),
						properties : (
							(TimingProperties::Period => {{100.0}}) ;
							(HybridSynchAADL::Synchronous => {{true}})),
						connections : (
							(ctrlThread .. oncontrol --> oncontrol) ;
							(ctrlThread .. releasedwater --> releasedwater) ;
							(decreasedwater --> ctrlThread .. decreasedwater) ;
							(ctrlThread .. power --> power) ;
							(ctrlThread .. offcontrol --> offcontrol) ;
							(currwater --> ctrlThread .. currwater)) 
						> ),
				properties : (
					(TimingProperties::Period => {{100.0}}) ;
					(HybridSynchAADL::MaxClockDeviation => {{5.0}}) ;
					(HybridSynchAADL::SamplingTime => {{20.0 .. 30.0}}) ;
					(HybridSynchAADL::ResponseTime => {{60.0 .. 80.0}}) ;
					(HybridSynchAADL::Synchronous => {{true}})),
				connections : (
					(ctrlProc .. releasedwater --> releasedwater) ;
					(ctrlProc .. power --> power) ;
					(ctrlProc .. offcontrol --> offcontrol) ;
					(currwater --> ctrlProc .. currwater) ;
					(decreasedwater --> ctrlProc .. decreasedwater) ;
					(ctrlProc .. oncontrol --> oncontrol)) 
				> 
			< waterTank2 : System |
				features : (
					< currwater : DataInPort | 
						cache : null(Real),
						content : null(Real) ,
						properties : none >
					< incomingwater : DataInPort | 
						cache : null(Real),
						content : null(Real) ,
						properties : none >
					< increasedwater : DataOutPort | 
						content : null(Real) ,
						properties : (DataModel::InitialValue => {{0}}) >
					< power : DataOutPort | 
						content : null(Real) ,
						properties : (DataModel::InitialValue => {{0}}) >
					< oncontrol : DataOutPort | 
						content : null(Unit) ,
						properties : none >
					< offcontrol : DataOutPort | 
						content : null(Unit) ,
						properties : none >),
				subcomponents : (
					< ctrlProc : Process |
						features : (
							< currwater : DataInPort | 
								cache : null(Real),
								content : null(Real) ,
								properties : none >
							< incomingwater : DataInPort | 
								cache : null(Real),
								content : null(Real) ,
								properties : none >
							< increasedwater : DataOutPort | 
								content : null(Real) ,
								properties : none >
							< power : DataOutPort | 
								content : null(Real) ,
								properties : none >
							< oncontrol : DataOutPort | 
								content : null(Unit) ,
								properties : none >
							< offcontrol : DataOutPort | 
								content : null(Unit) ,
								properties : none >),
						subcomponents : (
							< ctrlThread : Thread |
								features : (
									< currwater : DataInPort | 
										cache : null(Real),
										content : null(Real) ,
										properties : none >
									< incomingwater : DataInPort | 
										cache : null(Real),
										content : null(Real) ,
										properties : none >
									< increasedwater : DataOutPort | 
										content : null(Real) ,
										properties : none >
									< power : DataOutPort | 
										content : null(Real) ,
										properties : none >
									< oncontrol : DataOutPort | 
										content : null(Unit) ,
										properties : none >
									< offcontrol : DataOutPort | 
										content : null(Unit) ,
										properties : none >),
								subcomponents : (
									none),
								currState : (
									init),
								completeStates : (
									init),
								variables : (
									empty),
								transitions : (
									(init -[ on dispatch ]-> exec {
										(f{increasedwater} := f[incomingwater])
									}) ;
									(exec -[ [[true]] ]-> init {
										if ((f[currwater] <= [[33]])){
											(f{power} := [[0.5]]) ;
											(oncontrol !)
										}
										(
										(elsif ((f[currwater] <= [[39]])){
											(f{power} := [[0.3]]) ;
											(oncontrol !)
										})
										)
										else {
											{
												(f{power} := [[0.0]]) ;
												(offcontrol !)
											}
										}
										end if
									})),
								loopBound : (
									loopBoundNum),
								transBound : (
									transBoundNum),
								varGen : (
									< "TwoWaterTankSystemsimpleInstance.waterTank2.ctrlProc.ctrlThread" >
									),
								properties : (
									(TimingProperties::Period => {{100.0}}) ;
									(HybridSynchAADL::MaxClockDeviation => {{5.0}}) ;
									(HybridSynchAADL::SamplingTime => {{20.0 .. 30.0}}) ;
									(HybridSynchAADL::ResponseTime => {{60.0 .. 80.0}}) ;
									(HybridSynchAADL::Synchronous => {{true}})),
								connections : (
									empty) 
								> ),
						properties : (
							(TimingProperties::Period => {{100.0}}) ;
							(HybridSynchAADL::Synchronous => {{true}})),
						connections : (
							(ctrlThread .. oncontrol --> oncontrol) ;
							(ctrlThread .. offcontrol --> offcontrol) ;
							(incomingwater --> ctrlThread .. incomingwater) ;
							(ctrlThread .. power --> power) ;
							(currwater --> ctrlThread .. currwater) ;
							(ctrlThread .. increasedwater --> increasedwater)) 
						> ),
				properties : (
					(TimingProperties::Period => {{100.0}}) ;
					(HybridSynchAADL::MaxClockDeviation => {{5.0}}) ;
					(HybridSynchAADL::SamplingTime => {{20.0 .. 30.0}}) ;
					(HybridSynchAADL::ResponseTime => {{60.0 .. 80.0}}) ;
					(HybridSynchAADL::Synchronous => {{true}})),
				connections : (
					(ctrlProc .. increasedwater --> increasedwater) ;
					(currwater --> ctrlProc .. currwater) ;
					(incomingwater --> ctrlProc .. incomingwater) ;
					(ctrlProc .. offcontrol --> offcontrol) ;
					(ctrlProc .. power --> power) ;
					(ctrlProc .. oncontrol --> oncontrol)) 
				> 
			< env1 : Env |
				features : (
					< decreasedwater : EnvOutPort | 
						target : ctrlThread,
						envCache : null(Real),
						content : null(Real) ,
						properties : (DataModel::InitialValue => {{0}}) >
					< currwater : EnvOutPort | 
						target : ctrlThread,
						envCache : null(Real),
						content : null(Real) ,
						properties : (DataModel::InitialValue => {{0}}) >
					< power : EnvInPort | 
						target : ctrlThread,
						envCache : null(Real),
						content : null(Real) ,
						properties : none >
					< oncontrol : EnvInPort | 
						target : ctrlThread,
						envCache : null(Unit),
						content : null(Unit) ,
						properties : none >
					< offcontrol : EnvInPort | 
						target : ctrlThread,
						envCache : null(Unit),
						content : null(Unit) ,
						properties : none >),
				subcomponents : (
					< pumppower : Data |
						features : (
							none),
						subcomponents : (
							none),
						value : null(Real),
						properties : (
							(DataModel::InitialValue => {{0}})),
						connections : (
							empty) 
						> 
					< decrease : Data |
						features : (
							none),
						subcomponents : (
							none),
						value : null(Real),
						properties : (
							(DataModel::InitialValue => {{0}})),
						connections : (
							empty) 
						> 
					< water : Data |
						features : (
							none),
						subcomponents : (
							none),
						value : param(Real),
						properties : (
							none),
						connections : (
							empty) 
						> ),
				currMode : (
					off
					),
				jumps : (
					(off -[ (oncontrol) ]-> on) ;
					(off -[ (offcontrol) ]-> off) ;
					(on -[ (oncontrol) ]-> on) ;
					(on -[ (offcontrol) ]-> off)
					),
				flows : (
					((on)[(decrease(t) = (([[50.0]] * [[0.001]]) * v[t])) ; (water(t) = ((c[water] + c[pumppower]) - (([[50.0]] * [[0.001]]) * v[t]))) ] ) ;
					((off)[(decrease(t) = (([[50.0]] * [[0.001]]) * v[t])) ; (water(t) = (c[water] - (([[50.0]] * [[0.001]]) * v[t]))) ] )
					),
				sampling : (
					(ctrlThread : (rat(20.0),rat(30.0)))
					),
				response : (
					(ctrlThread : (rat(60.0),rat(80.0)))
					),
				varGen : (
					< "TwoWaterTankSystemsimpleInstance.env1" >
					),
				properties : (
					(TimingProperties::Period => {{100.0}}) ;
					(HybridSynchAADL::MaxClockDeviation => {{5.0}}) ;
					(HybridSynchAADL::Synchronous => {{true}}) ;
					(HybridSynchAADL::ContinuousDynamics => {{"decrease(t) = (50 * 0.001 * t) ; water(t) = water(0) - (50 * 0.001 * t)"}}) ;
					(HybridSynchAADL::isEnvironment => {{true}})),
				connections : (
					(water ==> currwater) ;
					(decrease ==> decreasedwater) ;
					(power =>> pumppower)) 
				> 
			< env2 : Env |
				features : (
					< currwater : EnvOutPort | 
						target : ctrlThread,
						envCache : null(Real),
						content : null(Real) ,
						properties : (DataModel::InitialValue => {{0}}) >
					< increasedwater : EnvInPort | 
						target : ctrlThread,
						envCache : null(Real),
						content : null(Real) ,
						properties : none >
					< power : EnvInPort | 
						target : ctrlThread,
						envCache : null(Real),
						content : null(Real) ,
						properties : none >
					< oncontrol : EnvInPort | 
						target : ctrlThread,
						envCache : null(Unit),
						content : null(Unit) ,
						properties : none >
					< offcontrol : EnvInPort | 
						target : ctrlThread,
						envCache : null(Unit),
						content : null(Unit) ,
						properties : none >),
				subcomponents : (
					< pumppower : Data |
						features : (
							none),
						subcomponents : (
							none),
						value : null(Real),
						properties : (
							(DataModel::InitialValue => {{0}})),
						connections : (
							empty) 
						> 
					< decrease : Data |
						features : (
							none),
						subcomponents : (
							none),
						value : null(Real),
						properties : (
							(DataModel::InitialValue => {{0}})),
						connections : (
							empty) 
						> 
					< increase : Data |
						features : (
							none),
						subcomponents : (
							none),
						value : null(Real),
						properties : (
							(DataModel::InitialValue => {{0}})),
						connections : (
							empty) 
						> 
					< water : Data |
						features : (
							none),
						subcomponents : (
							none),
						value : param(Real),
						properties : (
							none),
						connections : (
							empty) 
						> ),
				currMode : (
					off
					),
				jumps : (
					(off -[ (oncontrol) ]-> on) ;
					(off -[ (offcontrol) ]-> off) ;
					(on -[ (oncontrol) ]-> on) ;
					(on -[ (offcontrol) ]-> off)
					),
				flows : (
					((on)[(decrease(t) = (([[50.0]] * [[0.001]]) * v[t])) ; (water(t) = (((c[water] + c[pumppower]) - (([[50.0]] * [[0.001]]) * v[t])) + c[increase])) ] ) ;
					((off)[(decrease(t) = (([[50.0]] * [[0.001]]) * v[t])) ; (water(t) = ((c[water] - (([[50.0]] * [[0.001]]) * v[t])) + c[increase])) ] )
					),
				sampling : (
					(ctrlThread : (rat(20.0),rat(30.0)))
					),
				response : (
					(ctrlThread : (rat(60.0),rat(80.0)))
					),
				varGen : (
					< "TwoWaterTankSystemsimpleInstance.env2" >
					),
				properties : (
					(TimingProperties::Period => {{100.0}}) ;
					(HybridSynchAADL::MaxClockDeviation => {{5.0}}) ;
					(HybridSynchAADL::Synchronous => {{true}}) ;
					(HybridSynchAADL::ContinuousDynamics => {{"decrease(t) = (50 * 0.001 * t) ; water(t) = water(0) - (50 * 0.001 * t) + increase"}}) ;
					(HybridSynchAADL::isEnvironment => {{true}})),
				connections : (
					(increasedwater =>> increase) ;
					(power =>> pumppower) ;
					(water ==> currwater)) 
				> ),
		properties : (
			(TimingProperties::Period => {{100.0}}) ;
			(HybridSynchAADL::MaxClockDeviation => {{5.0}}) ;
			(HybridSynchAADL::Synchronous => {{true}})),
		connections : (
			(waterTank2 .. increasedwater --> env2 .. increasedwater) ;
			(env1 .. currwater --> waterTank1 .. currwater) ;
			(waterTank1 .. power --> env1 .. power) ;
			(env1 .. decreasedwater --> waterTank1 .. decreasedwater) ;
			(waterTank2 .. offcontrol --> env2 .. offcontrol) ;
			(env2 .. currwater --> waterTank2 .. currwater) ;
			(waterTank1 .. oncontrol --> env1 .. oncontrol) ;
			(waterTank1 .. offcontrol --> env1 .. offcontrol) ;
			(waterTank2 .. power --> env2 .. power) ;
			(waterTank2 .. oncontrol --> env2 .. oncontrol) ;
			(waterTank1 .. releasedwater --> waterTank2 .. incomingwater)) 
		>  .
endm
